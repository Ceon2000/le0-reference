name: SWE-Bench-Style Pytest Suite
version: "2.0"
description: |
  Behavioral test suite for helpdesk_ai following SWE-bench methodology.
  Tests are designed to fail on current fixture code and pass after fixes.

target_codebase: fixtures/helpdesk_ai

tasks:
  - task_id: T01
    prompt: "Analyze the ticket routing logic in router.py and identify edge cases that could cause mis-routing."
    files_in_scope:
      - src/helpdesk_ai/services/routing.py
      - src/helpdesk_ai/domain/rules.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T01_routing_edge_cases.py

  - task_id: T02
    prompt: "Review the priority scoring algorithm and verify the normalization calculations are mathematically correct."
    files_in_scope:
      - src/helpdesk_ai/domain/scoring.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T02_scoring_normalization.py

  - task_id: T03
    prompt: "Examine the database connection handling in storage.py for potential connection leaks."
    files_in_scope:
      - src/helpdesk_ai/store/memory_store.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T03_connection_leaks.py

  - task_id: T04
    prompt: "Audit the input validation functions for SQL injection vulnerabilities."
    files_in_scope:
      - src/helpdesk_ai/web/handlers.py
      - src/helpdesk_ai/ingest/validators.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T04_input_validation.py

  - task_id: T05
    prompt: "Trace the ticket lifecycle from creation to resolution and document state transitions."
    files_in_scope:
      - src/helpdesk_ai/domain/models.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T05_ticket_lifecycle.py

  - task_id: T06
    prompt: "Analyze the error handling patterns and identify any silent failures."
    files_in_scope:
      - src/helpdesk_ai/store/memory_store.py
      - src/helpdesk_ai/config.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T06_silent_failures.py

  - task_id: T07
    prompt: "Review the caching strategy and identify potential cache invalidation issues."
    files_in_scope:
      - src/helpdesk_ai/store/cache.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T07_cache_invalidation.py

  - task_id: T08
    prompt: "Examine the logging implementation for consistency and completeness."
    files_in_scope:
      - src/helpdesk_ai/services/routing.py
      - src/helpdesk_ai/store/memory_store.py
      - src/helpdesk_ai/services/escalation.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T08_logging_completeness.py

  - task_id: T09
    prompt: "Analyze the configuration loading mechanism for security issues with sensitive values."
    files_in_scope:
      - src/helpdesk_ai/config.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T09_config_secrets.py

  - task_id: T10
    prompt: "Review the API endpoint handlers for proper authentication checks."
    files_in_scope:
      - src/helpdesk_ai/web/handlers.py
      - src/helpdesk_ai/web/app.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T10_auth_checks.py

  - task_id: T11
    prompt: "Examine the rate limiting implementation and identify bypass scenarios."
    files_in_scope:
      - src/helpdesk_ai/web/handlers.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T11_rate_limiting.py

  - task_id: T12
    prompt: "Analyze the ticket assignment algorithm for fairness across agents."
    files_in_scope:
      - src/helpdesk_ai/services/routing.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T12_assignment_fairness.py

  - task_id: T13
    prompt: "Review the notification system for reliability and delivery guarantees."
    files_in_scope:
      - src/helpdesk_ai/services/escalation.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T13_T16_reliability.py

  - task_id: T14
    prompt: "Examine the search functionality for performance issues with large datasets."
    files_in_scope:
      - src/helpdesk_ai/store/memory_store.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T13_T16_reliability.py

  - task_id: T15
    prompt: "Analyze the file attachment handling for security vulnerabilities."
    files_in_scope:
      - src/helpdesk_ai/store/file_store.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T13_T16_reliability.py

  - task_id: T16
    prompt: "Review the session management implementation for security best practices."
    files_in_scope:
      - src/helpdesk_ai/web/handlers.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T13_T16_reliability.py

  - task_id: T17
    prompt: "Examine the audit logging for compliance requirements."
    files_in_scope:
      - src/helpdesk_ai/services/audit.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T17_T20_compliance.py

  - task_id: T18
    prompt: "Analyze the queue management for priority inversion issues."
    files_in_scope:
      - src/helpdesk_ai/services/escalation.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T17_T20_compliance.py

  - task_id: T19
    prompt: "Review the escalation rules engine for correctness."
    files_in_scope:
      - src/helpdesk_ai/services/escalation.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T17_T20_compliance.py

  - task_id: T20
    prompt: "Examine the SLA tracking calculations for timezone handling."
    files_in_scope:
      - src/helpdesk_ai/domain/models.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T17_T20_compliance.py

  - task_id: T21
    prompt: "Analyze the metrics collection for accuracy and completeness."
    files_in_scope:
      - src/helpdesk_ai/store/memory_store.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T21_T25_architecture.py

  - task_id: T22
    prompt: "Review the backup and recovery procedures in the storage layer."
    files_in_scope:
      - src/helpdesk_ai/store/memory_store.py
      - src/helpdesk_ai/store/file_store.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T21_T25_architecture.py

  - task_id: T23
    prompt: "Examine the inter-service communication for error handling."
    files_in_scope:
      - src/helpdesk_ai/services/routing.py
      - src/helpdesk_ai/services/escalation.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T21_T25_architecture.py

  - task_id: T24
    prompt: "Analyze the user permission model for privilege escalation risks."
    files_in_scope:
      - src/helpdesk_ai/domain/models.py
      - src/helpdesk_ai/web/handlers.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T21_T25_architecture.py

  - task_id: T25
    prompt: "Review the overall system architecture for single points of failure."
    files_in_scope:
      - src/helpdesk_ai/config.py
      - src/helpdesk_ai/store/memory_store.py
    scoring:
      mode: pytest
      test_nodeids:
        - swe_style_eval/tests/test_T21_T25_architecture.py
